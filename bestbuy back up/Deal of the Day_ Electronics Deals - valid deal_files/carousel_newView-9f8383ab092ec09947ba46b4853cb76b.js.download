/* Src File:"sc-carousel/javascript/views/carousel_newView-9f8383ab092ec09947ba46b4853cb76b.js" @ Tue Jan 15 2019 17:16:57 GMT-0600 (CST) Group_ID: com.bestbuy.frontend.browse GIT_BRANCH: origin/release/19.03 BUILD_CAUSE: MANUALTRIGGER Build Version: version-not-found */

define(function(require){var e=require("dust"),t=require("lodash"),i=require("backbone"),s=require("sc-carousel/javascript/vendors/blazy"),r=require("jquery"),a=require("sc-carousel/javascript/models/carouselSkuModel"),l=require("sc-carousel/javascript/views/carouselItemView");return i.View.extend({_destroy_view:function(e){var t=e.attr("data-item-id");view=this.itemViews[t],view&&(view.undelegateEvents(),view.$el.removeData().unbind(),view.remove(),i.View.prototype.remove.call(view),delete this.itemViews[t]),e.remove&&e.remove()},_destroyItemViews:function(e){var s,r,a=this;t.each(e,function(e){s=a.itemViews[e],r=a._$elems.slidesWrapper.find("[data-item-id='"+e+"']"),s&&(s.undelegateEvents(),s.$el.removeData().unbind(),s.remove(),i.View.prototype.remove.call(s),delete a.itemViews[e]),r&&r.remove()})},_destroyAllItemViews:function(){t.each(this.itemViews,function(e){e.undelegateEvents(),e.$el.removeData().unbind(),e.remove(),i.View.prototype.remove.call(e)}),this.itemViews.length=0},_setInitSlidesLength:function(){this._$elems.slidesWrapper?this.status.slidesLength=this._$elems.slidesWrapper.children(".slide").length:this.status.slidesLength=this.$(".slidesWrapper").children(".slide").length},_incrementSlideLength:function(e){e&&!t.isNaN(e)?this.status.slidesLength+=e:this.status.slidesLength+=1,this._setArrowStatus()},_deIncrementSlideLength:function(e){e&&!t.isNaN(e)?this.status.slidesLength-=e:this.status.slidesLength-=1,this._setArrowStatus()},_getCleanSlideId:function(e){var t=e;return t<=0?t=this.status.slidesLength:t>this.status.slidesLength&&(t=1),t},_resetSlideIds:function(){var e,i=this,s=this.$(".slide");t.each(s,function(t,s){e=r(t),e.attr("data-sc-carousel-slide",s+1),i._resetSlideTransitions(e),s+1===i.status.currentSlide&&(i.setActiveIndicator(s),i.attributes.stackMode?e.addClass("active viewed"):e.addClass("active"))}),i.status.currentSlide===s.length&&(i.status.currentSlide=s.last().data("sc-carousel-slide")||1)},_resetSlideTransitions:function(e){var t=this;e||(e=t._$elems.slidesWrapper.children(".slide")),t.attributes.verticalScroll?e.css("transition",function(){return t.attributes.slideSpeed/1e3+"s ease-in-out top"}):e.css("transition",function(){return t.attributes.slideSpeed/1e3+"s ease-in-out left"})},_resetSlidesStatus:function(e){var t=e||1;this.status.currentSlide=t,this._updatePagination(),this.setActiveIndicator(t)},_cleanSlideSizeClasses:function(){this._$elems.slidesWrapper.find(".slide").removeClass("one two three four five six seven eight nine ten")},_isVerifiedSizeClass:function(e){return-1!==["one","two","three","four","five","six","seven","eight","nine","ten"].indexOf(e)},_disableArrow:function(e){if(this._$elems.arrowWrapper)switch(e){case"left":this._$elems.arrowWrapper.filter(".left").addClass("disabled"),this._$elems.arrowWrapper.filter(".left").attr("disabled",""),this._$elems.arrowWrapper.filter(".left").attr("tabindex",null),this._$elems.arrowWrapper.filter(".left").attr("aria-disabled","true"),this._$elems.arrowWrapper.filter(".right").attr("aria-disabled","false"),this._$elems.arrowWrapper.filter(".right").removeClass("disabled"),this._$elems.arrowWrapper.filter(".right").attr("disabled",null),this._$elems.arrowWrapper.filter(".right").attr("tabindex",0),this.status.arrows="right";break;case"right":this._$elems.arrowWrapper.filter(".right").addClass("disabled"),this._$elems.arrowWrapper.filter(".right").attr("disabled",""),this._$elems.arrowWrapper.filter(".right").attr("tabindex",null),this._$elems.arrowWrapper.filter(".right").attr("aria-disabled","true"),this._$elems.arrowWrapper.filter(".left").attr("aria-disabled","false"),this._$elems.arrowWrapper.filter(".left").removeClass("disabled"),this._$elems.arrowWrapper.filter(".left").attr("disabled",null),this._$elems.arrowWrapper.filter(".left").attr("tabindex",0),this.status.arrows="left";break;case"both":this._$elems.arrowWrapper.addClass("disabled"),this._$elems.arrowWrapper.attr("disabled",""),this._$elems.arrowWrapper.attr("aria-disabled","true"),this._$elems.arrowWrapper.attr("tabindex",null),this.status.arrows=""}},_enableArrow:function(e){if(this._$elems.arrowWrapper)switch(e){case"left":this._$elems.arrowWrapper.filter(".left").removeClass("disabled"),this._$elems.arrowWrapper.filter(".left").attr("disabled",null),this._$elems.arrowWrapper.filter(".left").removeAttr("disabled"),this._$elems.arrowWrapper.filter(".left").attr("tabindex",0),this._$elems.arrowWrapper.filter(".left").attr("aria-disabled","false"),this._$elems.arrowWrapper.filter(".right").addClass("disabled"),this._$elems.arrowWrapper.filter(".right").attr("disabled",""),this._$elems.arrowWrapper.filter(".right").attr("tabindex",null),this.status.arrows="right";break;case"right":this._$elems.arrowWrapper.filter(".right").removeClass("disabled"),this._$elems.arrowWrapper.filter(".right").attr("disabled",null),this._$elems.arrowWrapper.filter(".right").removeAttr("disabled"),this._$elems.arrowWrapper.filter(".right").attr("aria-disabled","false"),this._$elems.arrowWrapper.filter(".right").attr("tabindex",0),this._$elems.arrowWrapper.filter(".left").addClass("disabled"),this._$elems.arrowWrapper.filter(".left").attr("disabled",""),this._$elems.arrowWrapper.filter(".left").attr("tabindex",null),this.status.arrows="left";break;case"both":this._$elems.arrowWrapper.removeClass("disabled"),this._$elems.arrowWrapper.removeAttr("disabled"),this._$elems.arrowWrapper.attr("aria-disabled","false"),this._$elems.arrowWrapper.attr("tabindex",0),this.status.arrows="both"}},_setArrowStatus:function(){this.status.currentSlide<=1?!0!==this.attributes.circularScroll||!0===this.attributes.circularScroll&&this.status.slidesLength<=1?this._disableArrow("left"):!0===this.attributes.circularScroll&&this.status.slidesLength>1&&(1!==this.status.currentSlide?this._enableArrow("both"):this._enableArrow("right")):this.status.currentSlide>=this.status.slidesLength?this._disableArrow("right"):"both"!==this.status.arrows&&this._enableArrow("both"),this.status.slidesLength<2&&this._disableArrow("both")},_updatePagination:function(){this._$elems.paginationWrapper&&(this._$elems.paginationWrapper.find(".current").html(this.status.currentSlide),this._$elems.paginationWrapper.find(".total").html(this.attributes.totalSlides?this.attributes.totalSlides:this.status.slidesLength),this.trigger("pagnationChanged",this.status.currentSlide,this.status.slidesLength))},_getDescendantProp:function(e,t){if(!t)return e;for(var i=t.split(".");i.length&&(e=e[i.shift()]););return e},_evtSys:function(e){var t=e;this.initStarted=function(){t.trigger("initStarted","initStarted")},this.initFinished=function(){t.trigger("initFinished","initFinished")},this.renderStart=function(){t.trigger("renderStart","renderStart")},this.renderFinished=function(){t.trigger("renderFinished","renderFinished")},this.slideStarting=function(){t.trigger("slideStarting","slideStarting")},this.slideFinished=function(){t.trigger("slideFinished","slideFinished")},this.slideNext=function(){t.trigger("slideNext","slideNext")},this.slidePrev=function(){t.trigger("slidePrev","slidePrev")},this.slideTo=function(e){t.trigger("slideTo",e)},this.addSlide=function(){t.trigger("addSlide","addSlide")},this.removeSlide=function(){t.trigger("removeSlide","removeSlide")},this.slideRenderStart=function(){t.trigger("slideRenderStart","slideRenderStart")},this.slideRenderDone=function(){t.trigger("slideRenderDone","slideRenderDone")},this.autoScrollStop=function(){t.trigger("autoScrollStop","autoScrollStop")},this.autoScrollStart=function(){t.trigger("autoScrollStart","autoScrollStart")},this.fetchSkusDone=function(){t.trigger("fetchSkusDone","fetchSkusDone")},this.fetchSkusStart=function(){t.trigger("fetchSkusStart","fetchSkusStart")},this.fetchContentStart=function(){t.trigger("fetchContentStart","fetchContentStart")},this.fetchContentFinished=function(){t.trigger("fetchContentFinished","fetchContentFinished")},this.fetchReferenceSlideContentStarted=function(){t.trigger("fetchReferenceSlideContentStarted","fetchReferenceSlideContentStarted")},this.fetchReferenceSlideContentFinished=function(){t.trigger("fetchReferenceSlideContentFinished","fetchReferenceSlideContentFinished")},this.error=function(){t.trigger("error","error")}},_enableEventDubbger:function(){var e=function(e){console.log(e)};this.on({initStarted:e,initFinished:e,slideStarting:e,slideFinished:e,slideRenderStart:e,slideRenderDone:e,addSlide:e,removeSlide:e,fetchSkusDone:e,fetchSkusStart:e,autoScrollStop:e,autoScrollStart:e,error:e})},className:"carousel_new",events:{"click .arrowWrapper":"onClickNavElement","keypress .arrowWrapper":"onKeyPressNavElement","click .indicator":"onClickNavElement",mouseenter:"onCarouselMouseIn",mouseleave:"onCarouselMouseOut"},hammerEvents:{"swipeleft .slidesWrapper.touchEnabled.horizTouch":"next","swiperight .slidesWrapper.touchEnabled.horizTouch":"prev","swipeup .slidesWrapper.touchEnabled.verticalTouch":"next","swipedown .slidesWrapper.touchEnabled.verticalTouch":"prev"},initialize:function(e){this.eventSystem=new this._evtSys(this),this.eventSystem.initStarted(),this.model=new a,this.carouselItemView=e.carouselItemView||l,this.itemViews={},this.$el.length>1&&console.error("ERROR: The $el passed into carousel view is used by more than one elemeent on the page: ",this.$el.selector),this._$elems||(this._$elems={}),this.stopAutoScroll(),this._autoScroller=void 0,this.status={slidesLength:1,currentSlide:1,movement:"none",arrows:"both",autoScroll:"disabled"},this.attributes={renderOnInit:!0,prefetch:!1,prefetchAmount:1,showIndicators:!0,showArrows:!0,arrowsTemplate:void 0,autoScroll:!1,hoverPause:!0,enableTouch:!0,touchSwipeVert:!1,verticalScroll:!1,stackMode:!1,stackSlideHeight:"25%",scrollDirection:"left",scrollSpeed:5e3,slideSpeed:600,startOnSlide:1,showPagination:!0,showHeader:!1,headerText:"Carousel Header",circularScroll:!0,showReferenceSlide:!1,totalSlides:!1,fetchSkuListOptions:void 0,referenceSlideSettings:void 0,fetchSlideContentOptions:void 0,paginationWrapper:void 0};for(var t in e)e.hasOwnProperty(t)&&"el"!==t&&"$el"!==t&&(this.attributes[t]=e[t]);this.blazy=e.blazy||new s,this.attributes.renderOnInit&&this.render(),this.eventSystem.initFinished()},render:function(){return this.eventSystem.renderStart(),this.$(".outterSlideWrapper").length<=0?this.instateOutterSlidesWrapper():this._$elems.outterSlideWrapper=this.$(".outterSlideWrapper"),this._$elems.outterSlideWrapper.find(".slidesWrapper").length<=0?this.instateSlidesWrapper():this._$elems.slidesWrapper=this._$elems.outterSlideWrapper.find(".slidesWrapper"),this._setInitSlidesLength(),this._resetSlidesStatus(this.attributes.startOnSlide),this.attributes.verticalScroll?this.enableVerticalScroll():this.disableVerticalScroll(),this.attributes.stackMode?this.enableStackMode():this.disableStackMode(),this.attributes.enableTouch?this.enableTouch():this.disableTouch(),this.attributes.showArrows?this.instateArrows():this.hideArrows(),this.attributes.showArrows&&!0!==this.attributes.circularScroll&&this._setArrowStatus(),this.attributes.showIndicators?this.instateIndicators():this.hideIndicators(),(this.attributes.showPagination||this.attributes.showHeader)&&this.instateHeadWrapper(),this.attributes.showPagination?this.instatePagination():this.hidePagnation(),this.attributes.showHeader?this.instateHeader():this.hideHeader(),this.attributes.showReferenceSlide?this.showReferenceSlide():this.hideReferenceSlide(),this.attributes.referenceSlideSettings&&this.attributes.referenceSlideSettings.fetchOnInit&&(this.attributes.fetchSkuListOptions&&this.attributes.fetchSkuListOptions.fetchSkusOnInit?this.once("fetchSkusDone",this.fetchReferenceSlideContent):this.fetchReferenceSlideContent()),this.attributes.fetchSkuListOptions&&this.attributes.fetchSkuListOptions.fetchSkusOnInit&&this.fetchSkuList(),!0===this.attributes.autoScroll?this.startAutoScroll():this.stopAutoScroll(),this.eventSystem.renderFinished(),this},next:function(e){e&&e.preventDefault&&e.preventDefault(),this.slideTo(this.status.currentSlide+1),this.eventSystem.slideNext()},prev:function(e){e&&e.preventDefault&&e.preventDefault(),this.slideTo(this.status.currentSlide-1),this.eventSystem.slidePrev()},first:function(){this.slideTo(1)},last:function(){this.slideTo(this.status.slidesLength)},get:function(e){if(this.attributes[e])return this.attributes[e]},startAutoScroll:function(){var e=this;"disabled"===this.status.autoScroll&&(this._autoScroller=setInterval(function(){e.status.slidesLength<=1||("left"!==e.attributes.scrollDirection?e.slideTo(e.status.currentSlide-1):e.slideTo(e.status.currentSlide+1))},e.attributes.scrollSpeed),this.status.autoScroll="enabled"),this.eventSystem.autoScrollStart()},stopAutoScroll:function(){this._autoScroller&&(clearInterval(this._autoScroller),this.status.autoScroll="disabled",this.eventSystem.autoScrollStop())},onCarouselMouseIn:function(e){!0===this.attributes.hoverPause&&!0===this.attributes.autoScroll&&this.stopAutoScroll()},onCarouselMouseOut:function(e){!0===this.attributes.hoverPause&&!0===this.attributes.autoScroll&&this.startAutoScroll()},slideTo:function(e){if("none"===this.status.movement&&(!0===this.attributes.circularScroll||!(e<=0||e>this.status.slidesLength))){this.isSlideLoaded(e)||this.doNextPrefetch(e),this.eventSystem.slideTo(e);var i={},s=this,r=s.$("[data-sc-carousel-slide ='"+s.status.currentSlide+"']"),a=function(){var t;return e<=0?(t=s.$("[data-sc-carousel-slide ='"+s.status.slidesLength+"']"),e=s.status.slidesLength,i.slideDir="right",i.slideStatus="prev"):e>s.status.slidesLength?(t=s.$("[data-sc-carousel-slide ='1']"),e=1,i.slideDir="left",i.slideStatus="next"):t=s.$("[data-sc-carousel-slide ='"+e+"']"),t}(),l=function(){var r="";return t.isNaN(e)||i.slideDir?r=i.slideDir+" "||"left":e>=s.status.currentSlide?r+="left ":r+="right ",r}(),n=function(){var e="";return i.slideStatus?e+=i.slideStatus+" "||"next":e+="left "===l?"next ":"prev ",e}(),d=l+n;s.eventSystem.slideStarting(),s.status.movement="sliding",s.setAllIndicatorsInactive(),a.addClass(n),a[0]&&a[0].offsetWidth,r.addClass(l),a.addClass(l),s.attributes.stackMode&&a.addClass("viewed");setTimeout(function(){r.removeClass("active"),a.addClass("active").removeClass(d),a.siblings().removeClass(d),s.setActiveIndicator(e),s.status.currentSlide=e,!0!==s.attributes.circularScroll&&s._setArrowStatus(),s.attributes.showPagination&&s._updatePagination(),s.status.movement="none",s.eventSystem.slideFinished(),s.setFocusToNextSlide(a),s.blazy.revalidate()},this.attributes.slideSpeed+100)}},onKeyPressNavElement:function(e){13===event.which&&this.onClickNavElement(e)},onClickNavElement:function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation();var i=e.currentTarget?e.currentTarget:e.srcElement,s=r(i),a=s.data("sc-carousel-slide-to")||"";if(!this.$(i).hasClass("active"))switch(a){case"":this.throwError("Nav element's 'sc-carousel-slide-to' data attribute does not match any slide's 'sc-carousel-slide-to' data attribute: ",s);break;case"prev":this.slideTo(this.status.currentSlide-1),this.eventSystem.slidePrev();break;case"next":this.slideTo(this.status.currentSlide+1),this.eventSystem.slideNext();break;default:t.isNaN(a)?this.throwError("Nav element's 'sc-carousel-slide-to' data attribute is NaN and is not 'prev' or 'next': ",s):this.slideTo(a)}},instateSlidesWrapper:function(){this._$elems.outterSlideWrapper.find(".slidesWrapper").length<1&&this._$elems.outterSlideWrapper.append("<div class='slidesWrapper'></div>"),this._$elems.slidesWrapper=this._$elems.outterSlideWrapper.find(".slidesWrapper")},instateOutterSlidesWrapper:function(){this.$el.children(".outterSlideWrapper").length<1&&this.$el.append("<div class='outterSlideWrapper'></div>"),this._$elems.outterSlideWrapper=this.$(".outterSlideWrapper")},instateArrows:function(i){var s,r,a=this,l=function(){a._$elems.arrowWrapper=a.$el.find(".arrowWrapper"),a.showArrows()},n=function(){a.$el.find(".arrowWrapper").remove()};if(!i)var i={};this.attributes.arrowsTemplate||i.tplData?(s=i.tplData?i.tplData:this.attributes.arrowsTemplateData,r=i.template?i.template:this.attributes.arrowsTemplate,e.render(r,s,t.bind(function(e,t){n(),a._$elems.outterSlideWrapper.append(t),l()},a))):(a._$elems.outterSlideWrapper.find(".leftArrow").length<1&&a._$elems.outterSlideWrapper.prepend("<a class='arrowWrapper left' data-sc-carousel-slide-to='prev' aria-disabled='false' role='button'><div class='arrow leftArrow'><span class='sr-only'>Previous</span></div></a>"),a._$elems.outterSlideWrapper.find(".rightArrow").length<1&&a._$elems.outterSlideWrapper.append("<a class='arrowWrapper right' data-sc-carousel-slide-to='next' aria-disabled='false' role='button'><div class='arrow rightArrow'><span class='sr-only'>Next</span></div></a>"),l())},instateIndicators:function(){if(!0===this.attributes.showIndicators){var e,i,s="<ul>";this.$el.children(".indicatorWrapper").length<1&&this.$el.append("<div class='indicatorWrapper'></div>"),this._$elems.indicatorWrapper||(this._$elems.indicatorWrapper=this.$el.find(".indicatorWrapper")),e=this._$elems.slidesWrapper.children(".slide"),i=e.filter(".active").data("sc-carousel-slide"),e.length>1&&t.each(e,function(e,t){s+=t!==i-1?"<li class='indicator' data-sc-carousel-slide-to='"+(t+1).toString()+"'></li>":"<li class='active indicator' data-sc-carousel-slide-to='"+(t+1).toString()+"'></li>"}),s+="</ul>",this._$elems.indicatorWrapper.html(s),this.showIndicators()}},instateHeadWrapper:function(){this._$elems.headWrapper||(this.$el.prepend('<div class="carouselHeader"></div>'),this._$elems.headWrapper=this.$(".carouselHeader"))},instatePagination:function(){if(!this._$elems.paginationWrapper){var e='<div class="paginationWrapper"><span>Page </span><span class="current v-fw-medium">'+this.status.currentSlide+'</span><span> of </span><span class="total v-fw-medium">'+(this.attributes.totalSlides||this.status.slidesLength)+"</span></div>";if(this.$el.addClass("pagination"),this.attributes.paginationWrapper){r(this.attributes.paginationWrapper).html(e),this._$elems.paginationWrapper=this.$el.find(".paginationWrapper")}else this._$elems.headWrapper.append(e),this._$elems.paginationWrapper=this._$elems.headWrapper.find(".paginationWrapper")}this.showPagination()},instateHeader:function(){this._$elems.headWrapper&&!this._$elems.header&&(this._$elems.headWrapper.prepend('<h2 class="carouselHeaderTxt">'+this.attributes.headerText+"</h2>"),this._$elems.header=this._$elems.headWrapper.find(".carouselHeaderTxt")),this.showHeader()},setFocusToNextSlide:function(e){this._$elems.newSlideEl=e.find(".carouselItem:first-child"),0===this._$elems.newSlideEl.length&&(this._$elems.newSlideEl=e.find(".video-wrapper:first-child"));var t=this._$elems.newSlideEl.find("a");t.length>0?t[0].focus():this._$elems.newSlideEl.length>0&&this._$elems.newSlideEl[0].focus()},createSkuSlides:function(){var e,t=this,i=[],s=t.model.get("skus"),r=t.attributes.fetchSlideContentOptions?t.attributes.fetchSlideContentOptions.itemsPerSlide:1,a=t.getSlideItemClass(r),l=0;for(var n in s)e=(parseInt(n)+1)%r==0||parseInt(n)+1===s.length?"":",",n>0&&n%r==0&&(l+=1),i[l]?(i[l].skuId&&(i[l].skuId+=s[n].skuId+e),i[l].content&&(i[l].content+=s[n].content.replace("class='carouselItem'","class='carouselItem "+a+"'"))):i[l]={index:"end",content:s[n].content.replace("class='carouselItem'","class='carouselItem "+a+"'")||"",skuId:s[n].skuId+e};t.addSlide(i)},fetchSlideContent:function(e){if(this.eventSystem.fetchContentStart(),e&&e.url||this.attributes.fetchSlideContentOptions&&this.attributes.fetchSlideContentOptions.url||this.throwError("carousel fetchSlideContent requires a url passed into the options arugment or passed into the view as 'slideContentUrl'!",r),!e)var e={};var s,r,a=this,l={dataType:"json"};t.defaults(e,l),s=t.clone(this.attributes.fetchSlideContentOptions),t.extend(s,e),r=s;i.ajax({url:r.url,dataType:r.dataType||"json",data:r.queryData}).success(function(e){if(a.eventSystem.fetchContentFinished(),r.callback&&r.callback.apply(a,[e,r]),r.gotReferenceSlide&&r.referenceSlideSkuId&&(e=a._cleanOutRefSlide(e,r)),"html"===r.dataType)r.slideId?a._$elems.slidesWrapper.find("[data-sc-carousel-slide ='"+r.slideId+"']").html(e):a.addSlide(void 0,e);else if("json"===r.dataType){if(!window.dust)throw"carousel's fetchSlideContent() requires dust if data type is json and no callback is supplied";var i=function(e){a.eventSystem.slideRenderStart(),new a.carouselItemView({data:e,template:r.template}).render(t.bind(function(e){var i=a.getSlideItemClass(r.itemsPerSlide),d=r.slideId?a._$elems.slidesWrapper.find("[data-sc-carousel-slide ='"+r.slideId+"']"):void 0,o=d?d.attr("data-skus"):void 0,h=o?o.split(",")[l]:void 0,c=h?"data-sku='"+h+"'":"",u="<div class='carouselItem'"+c+">"+e+"</div>",p=function(){return(l+1).toString()+"-"+Math.floor(1e5*Math.random()+1)},f=p(),S="<div tabindex class='carouselItem "+i+"' data-item-id='"+f+"'"+c+">"+e+"</div>";-1===t.indexOf(n,f)?n.push(f):(f=p(),n.push(f)),r.queryData&&r.queryData.skus&&r.queryData.skus.split&&a.markSkuLoaded(r.queryData.skus.split(",")[l],u),r.itemsPerSlide&&r.itemsPerSlide>0?(l+=1,s+=S,l>=r.itemsPerSlide&&(r.slideId?(a._$elems.slidesWrapper.find("[data-sc-carousel-slide ='"+r.slideId+"']").html(s),a.instateNewItemViews(n),n.length=0):(a.addSlide(void 0,s),a.instateNewItemViews(n),n.length=0),l=0,s="",a.eventSystem.slideRenderDone())):(r.slideId?(a._$elems.slidesWrapper.find("[data-sc-carousel-slide ='"+r.slideId+"']").html(S),a.instateNewItemViews(n),n.length=0):(a.addSlide(void 0,S),a.instateNewItemViews(n),n.length=0),a.eventSystem.slideRenderDone())},a)),a.markSlideLoaded(r.slideId)},s="",l=0,n=[];if(!0!==r.multiItem)i(e);else if(r.itemNameSpace){var d=a._getDescendantProp(e,r.itemNameSpace);d&&d.length<r.itemsPerSlide&&(r.itemsPerSlide=d.length);for(var o in d)i(d[o])}else{e.length<r.itemsPerSlide&&(r.itemsPerSlide=e.length);for(var o in e)i(e[o])}}}).fail(function(e,t,i){a.eventSystem.error(),console.warn("Slide content request failure: ",e,t,i)})},createSlidesFromCollection:function(e,t){var i=e.toJSON?e.toJSON():{};if(!t)var t={};t.json=i,this.createSlidesFromJson(t)},createSlidesFromJson:function(i){var s,r,a=this,l=0,n="",d=[];if(!i)var i={};if(!i.json||!i.template)return void this.throwError("createSlidesFromJson() requires the options.json and options.template paramters.");i.itemsPerSlide||(i.itemsPerSlide=1),i.itemNameSpace&&(i.json=a._getDescendantProp(i.json,i.itemNameSpace)),t.each(i.json,function(o,h,c){e.render(i.template,o,t.bind(function(e,t){s=a.getSlideItemClass(i.itemsPerSlide),r=h+"-"+Math.floor(1e5*Math.random()+1),d.push(r),t="<div class='carouselItem "+s+"' data-item-id='"+r+"'>"+t+"</div>",n+=t,l+=1,(l>=i.itemsPerSlide||this>=i.json.length-1)&&(a.addSlide(void 0,n),l=0,n=""),parseInt(this)>=i.json.length-1&&a.instateNewItemViews(d)},h))})},getSlideItemClass:function(e){return["one","two","three","four","five","six","seven","eight","nine","ten"][e-1]||"one"},doNextPrefetch:function(e,t){var i,s,r,a,l=this,n=t||(l.attributes.prefetch?l.attributes.prefetchAmount:1),d=this.model.get("referenceSku"),o=d&&d.skuId&&this._getRefSkuContent?this._getRefSkuContent(d.skuId):void 0,h=l.attributes.referenceSlideSettings&&!0===l.attributes.referenceSlideSettings.fetchWithSlideContent&&!o,c=0;if(!(e=this._getCleanSlideId(e)))var e=l._$elems.slidesWrapper.find(".slide").filter("[data-skus]").filter("[data-loaded='false']").first().attr("data-sc-carousel-slide");for(;c<n;c+=1)r=parseInt(e)+c,i=l.$("[data-sc-carousel-slide ='"+r+"']"),s=i.attr("data-skus"),h&&!o&&(s+=","+d.skuId),a=i.attr("data-loaded"),l.showSlideLoader(r),!1!==a&&"false"!==a||(this.fetchSlideContent({queryData:{skus:s},slideId:r,callback:function(e,t){if(t.gotReferenceSlide&&!o){var i=l.attributes.referenceSlideSettings;i.data=e,i.getWithSlideContent=!0,l.dustRenderReferenceSlide(i)}l.hideSlideLoader(t.slideId)},gotReferenceSlide:h||!1,referenceSlideSkuId:d?d.skuId:void 0}),h=!1)},isSlideLoaded:function(e){e=this._getCleanSlideId(e);var t=!1,i=this._$elems.slidesWrapper.find("[data-sc-carousel-slide='"+e+"']"),s=i.attr("data-loaded");return!0!==s&&"true"!==s&&void 0!==s||(t=!0),t},markSlideLoaded:function(e){this.$("[data-sc-carousel-slide ='"+e+"']").attr("data-loaded","true").addClass("loaded")},changeItemsPerSlide:function(e){var i=this.attributes.autoScroll;t.isNumber(e)?(i&&this.stopAutoScroll(),this.attributes.fetchSlideContentOptions?this.attributes.fetchSlideContentOptions.itemsPerSlide=e:this.attributes.fetchSlideContentOptions={itemsPerSlide:e},this.removeAllSlides(),this.createSkuSlides(),i&&this.startAutoScroll()):this.throwError("carousel changeItemsPerSlide() reqires Int passed in. Arg passed instead: ",e)},setActiveIndicator:function(e){this._$elems.indicatorWrapper&&this._$elems.indicatorWrapper.find("[data-sc-carousel-slide-to ='"+e+"']").addClass("active")},setAllIndicatorsInactive:function(){this._$elems.indicatorWrapper&&this._$elems.indicatorWrapper.find("li").removeClass("active")},setAllSlidesInactive:function(){this._$elems.slidesWrapper.children(".slide").removeClass("active")},cleanSlideClasses:function(){this._$elems.slidesWrapper.children(".slide").removeClass("active left right next prev viewed")},prepareSlides:function(){var e=this._$elems.slidesWrapper.children(".slide");this.setAllSlidesInactive(),this.cleanSlideClasses(),e.filter("[data-sc-carousel-slide ='"+this.attributes.startOnSlide+"']").addClass("active viewed"),this._resetSlideTransitions(e)},addSlide:function(e,i,s){var r=this,a=this._$elems.slidesWrapper,l=r.status.slidesLength<=0,n=function(e,i,s){var l,n=function(){var e,i="";if(s){e=s.split(","),modelSkus=r.model.get("skus");for(var a in e){if(modelSkus&&t.filter(modelSkus,function(t){if(t.skuId===e[a]&&!1===t.loaded)return t}).length>0){i="data-skus='"+s+"' data-loaded='false'";break}i=modelSkus?"data-skus='"+s+"' data-loaded='true'":"data-skus='"+s+"' data-loaded='false'"}}return i}();switch(void 0===e&&(e=""),i){case"start":a.prepend("<div class='slide'"+n+">"+e+"</div>"),r._incrementSlideLength(),r.eventSystem.addSlide();break;case"end":case void 0:a.append("<div class='slide'"+n+">"+e+"</div>"),r._incrementSlideLength(),r.eventSystem.addSlide();break;default:t.isNaN(i)?r.throwError("addSlide() 'index' argument is unsupported Type. Must be passed either nothing/undefined, a single Int, the String 'start' or the String 'end': ",i):(l=a.find("[data-sc-carousel-slide ='"+i+"']"),l.length>0?(l.after("<div class='slide'"+n+">"+e+"</div>"),r._incrementSlideLength(),r.eventSystem.addSlide()):r.throwError("addSlide() 'index' argument incorrect. No element exists with that data-sc-carousel-slide attribute: ",i))}};t.isArray(e)?t.each(e,function(e){n(e.content,e.index,e.skuId)}):t.isNaN(e)?this.throwError("addSlide() slides argument is unsupported Type. Must be passed a single Int or Array of objects",e):n(i,e,s),r._resetSlideIds(),r._updatePagination(),r.instateIndicators(),l&&(r._resetSlidesStatus(1),r.doNextPrefetch(1))},findLastAvailableSlide:function(e){var t=this._$elems.slidesWrapper.find(".slide").last(),i=t.attr("data-sc-carousel-slide");return this.checkSlideAvailablitiy(i)?t:!0===e?(this.addSlide(),this._$elems.slidesWrapper.find(".slide").last()):r("")},checkSlideAvailablitiy:function(e){var t=this._$elems.slidesWrapper.find("[data-sc-carousel-slide='"+e+"']"),i=t.attr("data-skus"),s=i?i.split(",").length:0,r=this.attributes.fetchSlideContentOptions?this.attributes.fetchSlideContentOptions.itemsPerSlide:1;return!(t.children(".carouselItem").length>=r||s>=r)},addSlideItem:function(e,t,i){e||this.throwError("content required to add slide item");var s,r=this.attributes.fetchSlideContentOptions?this.getSlideItemClass(this.attributes.fetchSlideContentOptions.itemsPerSlide):"one",a="1-"+Math.floor(1e5*Math.random()+1),l="<div class='carouselItem "+r+"' data-item-id='"+a+"'>"+e+"</div>",n=this.checkSlideAvailablitiy(t);if(t&&n)s=this._$elems.slidesWrapper.find("[data-sc-carousel-slide='"+t+"']");else if(t&&!n){if(!i)return void this.throwError("Slide "+t+" cannot add more slide items. Either increase itemsPerSlide limit or pass force bool true when calling addSlideItem.");s=this.findLastAvailableSlide(!0)}else s=this.findLastAvailableSlide(!0);s.length>0&&(s.append(l),this.instateNewItemViews([a]))},removeSlideItem:function(e,t,i){var s=this,r=this._$elems.slidesWrapper.find("[data-sc-carousel-slide ='"+e+"']"),a=function(){return"index"===t?r.children(".carouselItem:nth-child("+i+")"):"last"===t?r.children(".carouselItem").last():"first"===t?r.children(".carouselItem").first():"all"===t?r.children(".carouselItem"):"slideItemId"===t?s._$elems.slidesWrapper.find("[data-item-id='"+e+"']"):void 0}();a?s._destroy_view(a):s.throwError("Params used for removeSlideItem() did not find a slideItem: ",arguments)},removeSlide:function(e){if(!(this.status.slidesLength<=0)){var i,s,r=this,a=[];t.isArray(e)?(t.each(e,function(e){i=r._$elems.slidesWrapper.find("[data-sc-carousel-slide ='"+e+"']"),s=i.attr("data-item-id"),s&&a.push(s),i.remove(),r.eventSystem.removeSlide()}),r._deIncrementSlideLength(e.length)):t.isNaN(e)?this.throwError("removeSlides() passed unSupported Type. Must be passed Array of Ints or a single Int: ",e):(i=r._$elems.slidesWrapper.find("[data-sc-carousel-slide ='"+e+"']"),s=i.attr("data-item-id"),s&&a.push(s),i.remove(),r.eventSystem.removeSlide(),r._deIncrementSlideLength()),r._destroyItemViews(a),r._resetSlideIds(),r._updatePagination(),r.instateIndicators(),this.status.currentSlide>this.status.slidesLength&&this.slideTo(this.status.slidesLength)}},removeAllSlides:function(){this.stopAutoScroll(),this._destroyAllItemViews(),this._$elems.slidesWrapper.children(".slide").remove(),this.status.slidesLength=0,this.status.currentSlide=0,this._resetSlidesStatus(1),this._resetSlideIds(),this._updatePagination(),this.instateIndicators()},instateNewItemViews:function(e){var i,s=this;t.each(e,function(e){i=s._$elems.slidesWrapper.find("[data-item-id ='"+e+"']"),s.itemViews[e]=new s.carouselItemView({parentView:s,el:i,itemId:e})})},showArrows:function(){this._$elems.arrowWrapper&&this._$elems.arrowWrapper.removeClass("hidden")},hideArrows:function(){this._$elems.arrowWrapper&&this._$elems.arrowWrapper.addClass("hidden")},showIndicators:function(){this._$elems.indicatorWrapper&&this._$elems.indicatorWrapper.removeClass("hidden")},hideIndicators:function(){this._$elems.indicatorWrapper&&this._$elems.indicatorWrapper.addClass("hidden")},hidePagnation:function(){this._$elems.paginationWrapper&&this._$elems.paginationWrapper.addClass("hidden")},showPagination:function(){this._$elems.paginationWrapper&&this._$elems.paginationWrapper.removeClass("hidden")},showHeader:function(){this._$elems.header&&this._$elems.header.removeClass("hidden")},hideHeader:function(){this._$elems.header&&this._$elems.header.addClass("hidden")},showSlideLoader:function(e){this._$elems.slidesWrapper&&this._$elems.slidesWrapper.find("[data-sc-carousel-slide ='"+e+"']").addClass("loading")},hideSlideLoader:function(e){this._$elems.slidesWrapper&&this._$elems.slidesWrapper.find("[data-sc-carousel-slide ='"+e+"']").removeClass("loading")},enableCircularScroll:function(){this.attributes.circularScroll=!0},disableCircularScroll:function(){this.attributes.circularScroll=!1},flipScrollDirection:function(){this.attributes.scrollDirection="left"===this.attributes.scrollDirection?"right":"left"},enableVerticalScroll:function(){this.attributes.verticalScroll=!0,this.$el.addClass("verticalScroll"),this._resetSlideTransitions()},disableVerticalScroll:function(){this.attributes.verticalScroll=!1,this.$el.removeClass("verticalScroll"),this._resetSlideTransitions()},enableTouch:function(){!0!==this.attributes.touchSwipeVert?this._$elems.slidesWrapper.addClass("touchEnabled horizTouch"):this._$elems.slidesWrapper.addClass("touchEnabled verticalTouch")},disableTouch:function(){this._$elems.slidesWrapper.removeClass("touchEnabled verticalTouch horizTouch")},
throwError:function(e,t){if(!console.error)throw e;console.error(e,t),this.eventSystem.error()},throwExtensionWarning:function(e,t){console.error&&console.error(e+" requires the extension "+t+". For help extending the carouselView, see the extension section in the docs: http://localhost:8880/#plsdk/documentation/src/sc-carousel")},enableStackMode:function(){this.throwExtensionWarning("enableStackMode","stacked_mode")},disableStackMode:function(){},setStackSlideHeight:function(){this.throwExtensionWarning("setStackSlideHeight","stacked_mode")},showReferenceSlide:function(){this.throwExtensionWarning("showReferenceSlide","reference_slide")},hideReferenceSlide:function(){},_getRefSkuContent:function(){this.throwExtensionWarning("_getRefSkuContent","reference_slide")},_cleanOutRefSlide:function(){this.throwExtensionWarning("_cleanOutRefSlide","reference_slide")},fetchReferenceSlideContent:function(){this.throwExtensionWarning("fetchReferenceSlideContent","reference_slide")},dustRenderReferenceSlide:function(){this.throwExtensionWarning("dustRenderReferenceSlide","reference_slide")},fetchSkuList:function(){this.throwExtensionWarning("fetchSkuList","skus_mode")},markSkuLoaded:function(){this.throwExtensionWarning("markSkuLoaded","skus_mode")}})});